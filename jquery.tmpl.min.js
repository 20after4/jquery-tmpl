(function(a){var r=a.fn.domManip,f="_tmplitem",q=/^[^<]*(<[\w\W]+>)[^>]*$/,b={},i={},h,p={key:0,data:{}},d=0,c=0,g=[];function e(f,e,h,j){var c={data:j||(e?e.data:{}),_wrap:e?e._wrap:null,tmpl:null,parent:e||null,nodes:[],calls:u,nest:w,wrap:x,html:v,update:t};f&&a.extend(c,f,{nodes:[],parent:e});if(h){c.tmpl=h;c._ctnt=c._ctnt||c.tmpl(a,c);c.key=++d;(g.length?i:b)[d]=c}return c}a.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,d){a.fn[e]=function(m){var f=[],g=a(m),j=this.length===1&&this[0].parentNode;h=b||{};if(j&&j.nodeType===11&&j.childNodes.length===1&&g.length===1){g[d](this[0]);f=this}else{for(var i=0,n=g.length;i<n;i++){c=i;var k=(i>0?this.clone(true):this).get();a.fn[d].apply(a(g[i]),k);f=f.concat(k)}c=0;f=this.pushStack(f,e,g.selector)}var l=h;h=null;a.tmpl.complete(l);return f}});a.fn.extend({tmpl:function(d,c,b){return a.tmpl(this[0],d,c,b)},tmplItem:function(){return a.tmplItem(this[0])},template:function(b){return a.template(b,this[0])},domManip:function(d,l,j){if(d[0].nodeType){var e=a.makeArray(arguments),f=d.length,i=0,g;while(i<f&&!(g=a.data(d[i++],"tmplItem")));if(f>1)e[0]=[a.makeArray(d)];if(g&&c)e[2]=function(b){a.tmpl.afterManip(this,b,j)};r.apply(this,e)}else r.apply(this,arguments);c=0;!h&&a.tmpl.complete(b);return this}});a.extend({tmpl:function(f,g,h,c){var k,l=!c;if(l){c=p;f=a.template[f]||a.template(null,f)}else if(!f){f=c.tmpl;b[c.key]=c;c.nodes=[];n(c);return a(j(c,null,c.tmpl(a,c)))}if(!f)return[];if(typeof g==="function")g=g.call(c||{});if(h&&h.wrapped){c=e(h,c,null,g);c.key=++d;i[d]=c;c.tmpl=f;n(c)}k=a.isArray(g)?a.map(g,function(a){return a?e(h,c,f,a):null}):[e(h,c,f,g)];return l?a(j(c,null,k)):k},tmplItem:function(b){var c;if(b instanceof a)b=tmpl[0];while(b&&b.nodeType===1&&!(c=a.data(b,"tmplItem"))&&(b=b.parentNode));return c||p},template:function(c,b){if(b){if(typeof b==="string")b=o(b);else if(b instanceof a)b=b[0]||{};if(b.nodeType)b=a.data(b,"tmpl")||a.data(b,"tmpl",o(b.innerHTML));return typeof c==="string"?(a.template[c]=b):b}return typeof c!=="string"?a.template(null,c):a.template[c]||a.template(null,q.test(c)?c:a(c))},encode:function(a){return(""+a).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}});a.extend(a.tmpl,{tags:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){_=_.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(_,$1,$2);_=[];",close:"call=$item.calls();_=call._.concat($item.wrap(call,_));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},"if":{open:"if(($notnull_1) && $1a){",close:"}"},"else":{open:"}else{"},html:{open:"if($notnull_1){_.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){_.push($.encode($1a));}"}},complete:function(){b={}},afterManip:function(f,b,d){var e=b.nodeType===11?a.makeArray(b.childNodes):b.nodeType===1?[b]:[];d.call(f,b);m(e);c++}});function j(d,g,e){var b,c=a.map(e,function(a){return typeof a==="string"?a.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+f+'="'+d.key+'" $2'):j(a,d,a._ctnt)});if(g)return c;c=c.join("");c.replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(f,c,e,d){b=a(e).get();m(b);if(c)b=k(c).concat(b);if(d)b=b.concat(k(d))});return b?b:k(c)}function k(c){var b=document.createElement("div");b.innerHTML=c;return a.makeArray(b.childNodes)}function o(b){return new Function("jQuery","$item","var $=jQuery,_=[],$data=$item.data;with($data){_.push('"+$.trim(b).replace(/([\\'])/g,"\\$1").replace(/[\r\t\n]/g," ").replace(/\${([^}]*)}/g,"{{= $1}}").replace(/{{(\/?)(\w+|.)(?:\(((?:.(?!}}))*?)?\))?(?:\s+(.*?)?)?(\((.*?)\))?\s*}}/g,function(m,k,j,d,b,f,c){var g=a.tmpl.tags[j],h,e,i;if(!g)throw"Template command not found: "+j;h=g._default||[];if(b){b=l(b);c=c?","+l(c)+")":f?")":"";if(f&&b.indexOf(".")>-1){b+=f;c=""}e=c?"("+b+").call($item"+c:b;i=c?e:"(typeof("+b+")==='function'?("+b+").call($item):("+b+"))"}else e=h.$1||"null";d=l(d);return"');"+g[k?"close":"open"].split("$notnull_1").join("typeof("+b+")!=='undefined' && ("+b+")!=null").split("$1a").join(i).split("$1").join(e).split("$2").join(d?d.replace(/\s*([^\(]+)\s*(\((.*?)\))?/g,function(d,c,b,a){a=a?","+a+")":b?")":"";return a?"("+c+").call($item"+a:d}):h.$2||"")+"_.push('"})+"');}return _;")}function n(c){if(c.wrapped){var b=c.wrapped;c._wrap=j(c,true,a.isArray(b)?b:[q.test(b)?b:a(b).html()]).join("")}}function l(a){return a?a.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(b){var a=document.createElement("div");a.appendChild(b.cloneNode(true));return a.innerHTML}function m(o){for(var n="_"+c,h,g,l={},j=0,p=o.length;j<p;j++){if((h=o[j]).nodeType!==1)continue;g=h.getElementsByTagName("*");for(var k=g.length-1;k>=0;k--)m(g[k]);m(h)}function m(j){var p,h=j,k,g,m;if(m=j.getAttribute(f)){while((h=h.parentNode).nodeType===1&&!(p=h.getAttribute(f)));if(p!==m){h=h.nodeType===11?0:h.getAttribute(f)||0;if(!(g=b[m])){g=i[m];g=e(g,b[h]||i[h],null,true);g.key=++d;b[d]=g}c&&o(m)}j.removeAttribute(f)}else if(c&&(g=a.data(j,"tmplItem"))){o(g.key);b[g.key]=g;h=a.data(j.parentNode,"tmplItem");h=h?h.key:0}if(g){k=g;while(k&&k.key!=h){k.nodes.push(j);k=k.parent}delete g._ctnt;delete g._wrap;a.data(j,"tmplItem",g)}function o(a){a=a+n;g=l[a]=l[a]||e(g,b[g.parent.key+n]||g.parent,null,true)}}}function u(a,e,d,c){if(!a)return g.pop();var b=g.length;g.push({_:a,tmpl:e,parent:b?g[b-1].item:this,item:this,data:d,options:c})}function w(d,c,b){return a.tmpl(a.template(d),c,b,this)}function x(b,d){var c=b.options||{};c.wrapped=d;return a.tmpl(a.template(b.tmpl),b.data,c,b.parent)}function v(d,c){var b=this._wrap;return a.map(a(a.isArray(b)?b.join(""):b).filter(d||"*"),function(a){return c?a.innerText||a.textContent:a.outerHTML||s(a)})}function t(){var b=this.nodes;a.tmpl(null,null,null,this).insertBefore(b[0]);a(b).remove()}})(jQuery)